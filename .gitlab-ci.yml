.ansible:
  stage: ansible-bootstrap
  image: willhallonline/ansible:latest
  before_script:
    - pip3 install -r requirements.txt 
    - echo ${ROUTER_PRIVATE_KEY_BASE64}|base64 -d > tmp
    - chmod 600 tmp
    - mkdir ~/.ssh
    - cp ansible/known_hosts ~/.ssh/known_hosts

stages:
  - ansible-bootstrap
  - ansible-main

bootstrap-config:
  extends: .ansible
  script:
    - ansible-playbook -i ansible/inventory.yml -u root --private-key=tmp ansible/bootstrap.yml 

#general-config:
#  extends: .ansible
#  stage: ansible-main
#  script:
#    - ansible-playbook -i ansible/inventory.yml -u root --private-key=tmp ansible/main.yml
