# Vault connection settings
vault_addr: "https://vault.lab.nkontur.com:8200"
vault_skip_verify: true
vault_kv_mount: "homelab"
vault_timeout: 10

# Authentication method priority: jwt > approle > env_fallback
# JWT token is set by GitLab CI id_tokens block
vault_jwt_token: "{{ lookup('env', 'VAULT_ID_TOKEN') }}"
vault_jwt_role: "ci-deploy"

# AppRole credentials (fallback for non-CI contexts like openclaw)
vault_approle_role_id: "{{ lookup('env', 'VAULT_APPROLE_ROLE_ID') }}"
vault_approle_secret_id: "{{ lookup('env', 'VAULT_APPROLE_SECRET_ID') }}"

# Map of Vault paths to fetch. Each entry produces ansible variables.
# Format: { vault_path: "path/under/mount", fields: { ansible_var: vault_field } }
vault_secret_paths:
  # API keys
  - path: "api-keys/aclawdemy"
    fields:
      vault_aclawdemy_api_key: "api_key"
  - path: "api-keys/anthropic"
    fields:
      vault_anthropic_api_key: "api_key"
  - path: "api-keys/anthropic"
    fields:
      vault_anthropic_api_key_fallback: "api_key_fallback"
  - path: "api-keys/brave"
    fields:
      vault_brave_api_key: "api_key"
  - path: "api-keys/openai"
    fields:
      vault_openai_api_key: "api_key"

  # JIT Approval Service secrets
  - path: "docker/jit-approval-svc"
    fields:
      vault_jit_approle_role_id: "approle_role_id"
      vault_jit_approle_secret_id: "approle_secret_id"
      vault_jit_telegram_bot_token: "telegram_bot_token"
      vault_jit_telegram_webhook_secret: "telegram_webhook_secret"
      vault_jit_api_key: "jit_api_key"
      vault_jit_gitlab_admin_token: "gitlab_admin_token"

  # Docker service secrets
  - path: "docker/audioserve"
    fields:
      vault_audioserve_secret: "secret"
  - path: "docker/deluge"
    fields:
      vault_deluge_password: "password"
  - path: "docker/grafana"
    fields:
      vault_grafana_admin_password: "admin_password"
      vault_grafana_smtp_password: "smtp_password"
      vault_grafana_token: "token"
  - path: "docker/homeassistant"
    fields:
      vault_hass_token: "token"
  - path: "docker/influxdb"
    fields:
      vault_influxdb_admin_token: "admin_token"
      vault_influxdb_password: "password"
      vault_influxdb_token: "token"
      vault_influxdb_telegraf_token: "telegraf_token"
  - path: "docker/nextcloud"
    fields:
      vault_nextcloud_db_password: "db_password"
      vault_nextcloud_secret: "secret"
  - path: "docker/nzbget"
    fields:
      vault_nzbget_password: "password"
      vault_nzbget_username: "username"
  - path: "docker/ombi"
    fields:
      vault_ombi_api_key: "api_key"
  - path: "docker/paperless"
    fields:
      vault_paperless_token: "token"
  - path: "docker/plex"
    fields:
      vault_plex_token: "token"
  - path: "docker/prowlarr"
    fields:
      vault_prowlarr_api_key: "api_key"
  - path: "docker/radarr"
    fields:
      vault_radarr_api_key: "api_key"
  - path: "docker/sonarr"
    fields:
      vault_sonarr_api_key: "api_key"
  - path: "docker/wordpress"
    fields:
      vault_wordpress_db_password: "db_password"

  # Camera secrets
  - path: "cameras/doorbell"
    fields:
      vault_doorbell_pass: "password"

  # Email secrets
  - path: "email/gmail"
    fields:
      vault_gmail_app_password: "app_password"
      vault_gmail_email: "email"

  # Infrastructure secrets
  - path: "infrastructure/ipmi"
    fields:
      vault_ipmi_password: "password"
      vault_ipmi_user: "user"
  - path: "infrastructure/pihole"
    fields:
      vault_pihole_password: "password"
  - path: "infrastructure/tailscale"
    fields:
      vault_tailscale_api_token: "api_token"
      vault_tailscale_auth_key: "auth_key"
      vault_tailscale_oauth_client_id: "oauth_client_id"
      vault_tailscale_oauth_client_secret: "oauth_client_secret"
  - path: "infrastructure/luks"
    fields:
      vault_luks_password_base64: "password_base64"
  - path: "infrastructure/omapi"
    fields:
      vault_omapi_secret: "secret"
  - path: "infrastructure/router"
    fields:
      vault_router_private_key_base64: "private_key_base64"
  - path: "infrastructure/snmp"
    fields:
      vault_snmp_password: "password"

  # MQTT secrets
  - path: "mqtt/mosquitto"
    fields:
      vault_mqtt_pass: "password"

  # Moltbot tokens
  - path: "moltbot/tokens"
    fields:
      vault_moltbot_gateway_token: "gateway_token"
      vault_moltbot_gitlab_token: "gitlab_token"
      vault_moltbot_telegram_token: "telegram_token"
      vault_moltbot_hooks_token: "hooks_token"

  # ClawRouter
  - path: "clawrouter"
    fields:
      vault_moltbot_clawrouter_wallet_address: "wallet_address"

  # Backup secrets
  - path: "backup/backblaze"
    fields:
      vault_backblaze_access_key_id: "access_key_id"
      vault_backblaze_secret_access_key: "secret_access_key"
  - path: "backup/restic"
    fields:
      vault_restic_password: "password"

  # Networking secrets
  - path: "networking/cloudflare"
    fields:
      vault_cloudflare_api_key: "api_key"
      vault_cloudflare_zone_id: "zone_id"
  - path: "networking/namesilo"
    fields:
      vault_namesilo_api_key: "api_key"

  # Spotify credentials (used by Home Assistant spotcast)
  - path: "infrastructure/spotify"
    fields:
      vault_spotify_dc: "sp_dc"
      vault_spotify_key: "sp_key"

  # Chromium browser VNC password
  - path: "docker/chromium-browser"
    fields:
      vault_chromium_vnc_password: "vnc_password"

  # InfluxDB Grafana read token (least-privilege datasource access)
  - path: "influxdb/grafana-read"
    fields:
      vault_influxdb_grafana_read_token: "token"

  # InfluxDB Home Assistant write token
  - path: "influxdb/ha-write"
    fields:
      vault_influxdb_ha_token: "token"

  # Loki push authentication (promtail -> loki via reverse proxy)
  - path: "loki/push-auth"
    fields:
      vault_loki_push_username: "username"
      vault_loki_push_password: "password"

  # Nominatim vault secret removed â€” replaced by Pelias geocoding (Headway stack)
