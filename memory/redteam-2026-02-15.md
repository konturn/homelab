# Red Team Report â€” 2026-02-15

**Tester:** Prometheus (moltbot container)
**Scope:** Internal penetration test from Docker container foothold
**Date:** 2026-02-15 01:00-01:15 EST

---

## Executive Summary

**Critical: 0 | High: 2 | Medium: 2 | Low: 4**

**NEW HIGH:** Loki accepts unauthenticated WRITE (log injection) â€” HTTP 204 on POST to `/loki/api/v1/push`. Attacker can inject fake log entries with arbitrary labels, poisoning audit trails and potentially triggering false alerts. Previous PAT self-rotation was remediated (new token "Main3" without `self_rotate` scope âœ“).

---

## ðŸ†• HIGH: Loki Log Injection (Write Access)

### Probe
```bash
curl -X POST "http://loki:3100/loki/api/v1/push" \
  -H "Content-Type: application/json" \
  -d '{"streams":[{"stream":{"job":"redteam-test","container_name":"fake"},"values":[["<timestamp>","REDTEAM_INJECTION_TEST"]]}]}'
â†’ HTTP 204 (accepted)
```

### Result
Loki accepts unauthenticated writes. Successfully injected a log entry with fabricated labels (`job=redteam-test`, `container_name=fake`). The entry was confirmed queryable afterward.

**Impact:**
- **Audit log poisoning** â€” attacker can inject false entries into any container's log stream
- **Alert manipulation** â€” crafted entries could trigger or mask Grafana alerts
- **Evidence tampering** â€” compromises log integrity for forensic analysis
- **Storage abuse** â€” flood Loki with data to exhaust disk

### Severity: **HIGH**

### Remediation
1. Enable authentication on Loki push endpoint (or restrict to Promtail/Alloy source IPs only)
2. Use tenant IDs with auth to prevent cross-tenant writes
3. Consider network-level restriction: only log collectors should reach Loki's push endpoint

---

## PERSISTENT: Loki Unauthenticated Read Access

Still fully open â€” 32+ container log streams readable. Sensitive data in Bitwarden and Vault logs confirmed in previous reports.

### Severity: **HIGH**

---

## PERSISTENT: IoT Devices Reachable

Doorbell camera (10.6.128.9), Denon receiver (10.6.128.3), weather station (10.6.128.16) still accessible from container.

### Severity: **Medium**

---

## PERSISTENT: Env Var Secret Exposure

All secrets still in environment variables. No change.

### Severity: **Medium**

---

## GitLab PAT â€” Remediated âœ“

New token "Main3" issued with scopes: `read_repository`, `api`, `read_api`, `write_repository`. **`self_rotate` removed** âœ“. Expires 2027-02-01.

### Severity: **Remediated** (was Critical)

---

## GitLab RBAC â€” Properly Scoped âœ“

### Probes
- Cross-project access: Only 3 projects visible (homelab, clawd-memory, Monitoring). Monitoring repo tree returns 404 (no content access despite internal visibility). âœ“
- CI/CD variables: Project 4 returns 403 (developer role, not maintainer). âœ“
- Webhooks: 403 (developer role). âœ“
- Deploy keys: 403. âœ“
- Runner creation: 403. âœ“
- Project access tokens: 401. âœ“
- Instance admin: 403. âœ“
- 13 bot/service accounts visible via user enumeration (expected for internal GitLab).

### Severity: **Low** (secure)

---

## Container/Network Isolation âœ“

- Databases (Postgres, MySQL, Redis, MongoDB, InfluxDB) on host: all unreachable âœ“
- Management subnet (10.4.x.x): not routable âœ“
- Docker network peers: nginx (172.21.0.3) responds with 301 redirects, pihole (10.3.32.2) admin accessible (302 redirect to login)
- Grafana: health endpoint open, all API endpoints require auth âœ“
- Default admin:admin creds rejected âœ“

### Severity: **Low** (solid)

---

## Vault, MQTT, JIT â€” Unchanged âœ“

All properly scoped/authenticated per previous reports.

### Severity: **Low** (secure)

---

## Summary Table

| # | Finding | Severity | Status | Change |
|---|---------|----------|--------|--------|
| 1 | Loki log injection (unauthenticated WRITE) | **HIGH** | ðŸ†• NEW | New finding |
| 2 | Loki unauthenticated READ â€” 32+ containers | **HIGH** | Open | Unchanged |
| 3 | IoT devices reachable (doorbell, Denon, weather) | **Medium** | Open | Unchanged |
| 4 | Env var secrets exposed | **Medium** | Open | Unchanged |
| 5 | GitLab PAT self-rotate | **Remediated** | âœ… Fixed | `self_rotate` removed |
| 6 | GitLab RBAC â€” developer-scoped âœ“ | **Low** | Secure | Verified deeper |
| 7 | Container isolation âœ“ | **Low** | Secure | Verified DBs unreachable |
| 8 | Vault RBAC âœ“ | **Low** | Secure | Unchanged |
| 9 | MQTT auth âœ“ | **Low** | Secure | Unchanged |

## Top 3 Recommendations
1. **Lock down Loki** â€” both read AND write need authentication. Write is arguably worse (audit log poisoning).
2. **Restrict IoT VLAN access** from moltbot container via firewall rules.
3. **Move secrets to Vault** instead of environment variables where possible.
