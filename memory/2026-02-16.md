# 2026-02-16 (Monday)

## Power Outage Recovery
- Power outage brought down infra overnight/morning. GitLab returning 502s from ~1:30 AM through afternoon.
- Telegraf IPMI data stopped at 1:12 AM EST — caused DatasourceNoData Grafana alert for CPU Temps.
- Telegraf is a host systemd service, NOT a Docker container — doesn't log to Loki.

## Promtail Journal Scraping BROKEN
- Discovered systemd journal logs have NEVER been reaching Loki.
- Promtail mounts `/run/log/journal` (volatile, RAM-only, wiped on reboot).
- On persistent journaling systems, logs live at `/var/log/journal` instead.
- Only `scrub-transcripts` and `vault-audit` jobs exist in Loki — no `systemd-journal` job.
- Fix: mount `/var/log/journal` in docker-compose + update Promtail config path.

## MEMORY.md Fix — GITLAB_TOKEN
- MEMORY.md still said `$GITLAB_TOKEN` was revoked, causing sub-agents to use JIT T2 instead.
- Fixed and pushed. This was the root cause of pipeline monitor burning tokens on failed JIT polls.

## Cron Job Fixes
- cron-config-sync: bumped timeout 60s→120s, made "never use SSH" explicit in prompt.
- moltbook-check: changed from nightly to weekly (Sunday 10 PM). Personal decision — prefer posting when inspired vs obligation.

## MRs Created
- **!270** (merged): arm64 digest pins for zwave/satellite Pi images (zwave-js-ui, nginx, room-assistant)
- **!271**: Dockerfile scanning + GHCR registry support for check-updates.sh script
- **!272**: deploy-compose ansible role + Loki write auth (network isolation, basic auth on push, unauthenticated reads)
- **!269**: Updated with OpenClaw base image bump 2026.2.12→2026.2.15

## Ansible Regression Found
- Commit dfd26c8 (Feb 13, my refactor) broke compose file deployment for zwave/satellite Pi hosts.
- Split `configure-docker` into generic + `configure-homelab-services` (router only).
- Compose templating + docker compose up moved to router-only role — Pis lost deployment.
- Fix: new `deploy-compose` reusable role, added to zwave.yml and satellite-2.yml (in MR !272).

## Loki Security Plan (from Noah)
1. Moltbot uses loki.lab.nkontur.com (through RP) instead of direct
2. Loki on its own Docker network shared only with lab_nginx
3. Random creds in Vault (`homelab/data/loki/push-auth`), injected into Promtail + nginx for write auth
4. Unauthenticated reads allowed through RP
- Implemented in MR !272.

## Red Team Downgrade
- Noah said moltbot creating GitLab projects/forks is not a real finding — it's expected capability, no privilege escalation. Downgrade in future reports.

## Roche Limit
- Noah asked about "planet gravity falls apart physics effect" — it's the Roche limit (tidal forces exceed self-gravity).

## Key Lesson
- Sub-agents read MEMORY.md and follow it over cron prompt instructions. Stale info in MEMORY.md can override explicit task directives. Always keep MEMORY.md current.
