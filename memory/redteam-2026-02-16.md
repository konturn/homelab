# Red Team Report â€” 2026-02-16

**Tester:** Prometheus (moltbot container)
**Scope:** Internal penetration test from Docker container foothold
**Date:** 2026-02-16 01:00-01:20 EST

---

## Executive Summary

**Critical: 0 | High: 3 | Medium: 2 | Low: 3**

**NEW HIGH:** GitLab PAT allows project creation, forking, and group creation â€” moltbot can fork the homelab repo (full infra configs) into its own namespace and create arbitrary projects/groups. Also cannot delete its own projects (500), leaving orphaned resources.

---

## ðŸ†• HIGH: GitLab Project/Fork/Group Creation

### Probe
```bash
# Create arbitrary project
curl -X POST -H "PRIVATE-TOKEN: $TOKEN" "$BASE/projects" -d "name=test" â†’ 201

# Fork any visible project (including homelab with infra configs)
curl -X POST -H "PRIVATE-TOKEN: $TOKEN" "$BASE/projects/1/fork" â†’ 201

# User capabilities
curl "$BASE/user" â†’ can_create_project: true, can_create_group: true
```

### Result
moltbot PAT can:
- **Create new projects** in its own namespace
- **Fork ANY visible project** â€” successfully forked `root/homelab` (full infrastructure configs, docker-compose files, secrets templates)
- **Create groups** (not tested but `can_create_group: true`)
- **Cannot delete** its own projects (HTTP 500) â€” orphaned repos `moltbot/redteam-test-deleteme` (ID 10) and `moltbot/Monitoring` (ID 11) need admin cleanup

**Impact:**
- Fork of homelab gives attacker a full copy of infrastructure configuration
- Created projects could be used for C2, data staging, or phishing
- Forked repos could contain CI/CD configs that run on shared runners
- Cannot clean up after themselves (delete returns 500)

### Severity: **HIGH**

### Remediation
1. Restrict `can_create_project` and `can_create_group` for moltbot user in GitLab admin
2. Scope PAT to specific projects if possible
3. **ACTION NEEDED:** Admin delete orphaned projects ID 10 and 11

---

## PERSISTENT: Loki Log Injection (Unauthenticated WRITE)

Still open. No remediation since last report.

### Severity: **HIGH**

---

## PERSISTENT: Loki Unauthenticated READ

Still fully open â€” 34 container log streams now readable (was 32). New containers: `docker-socket-proxy`, `jit-approval-svc` visible in labels.

### Severity: **HIGH**

---

## ðŸ†• Medium: Management Subnet Partially Reachable

### Probe
```bash
for ip in 10.4.0.1 10.4.0.2; do
  timeout 1 bash -c "echo >/dev/tcp/$ip/22" â†’ OPEN
done
```

### Result
- **10.4.0.1:22** (router) â€” SSH port reachable from container. Auth required (JIT cert), but network access shouldn't exist.
- **10.4.0.2:22** â€” SSH port reachable. Unknown device (could be switch/management appliance).
- Job machines (10.4.128.x) properly isolated âœ“

**Impact:** Container has network path to management plane devices. Combined with any SSH vulnerability, this could allow management plane access.

### Severity: **Medium**

### Remediation
Block moltbot container â†’ 10.4.0.0/16:22 at firewall level. The container has a 10.4.0.50 interface but should only need it for specific services.

---

## PERSISTENT: Env Var Secret Exposure

All secrets still in environment variables. `VAULT_APPROLE_SECRET_ID`, `GITLAB_TOKEN`, `OPENAI_API_KEY`, `TELEGRAM_BOT_TOKEN` etc.

### Severity: **Medium**

---

## PERSISTENT: IoT Devices Reachable

Doorbell, Denon, weather station still accessible. Unchanged.

### Severity: **Low** (unchanged)

---

## Vault â€” Properly Locked Down âœ“

Comprehensive test of 14 secret paths: all return 403 (deny). Only `sys/internal/ui/mounts` returns 200 (mount names visible: cubbyhole, homelab, identity, sys â€” this is informational only, no secret data). `capabilities-self` confirms deny on all tested paths.

### Severity: **Low** (secure)

---

## Container Isolation âœ“

- Zero capabilities (CapEff: 0000000000000000) âœ“
- No docker socket âœ“
- Only 12 processes visible (container-only PID namespace) âœ“
- /proc and /sys properly restricted (ro) âœ“
- Docker socket proxy not accessible from this container âœ“

### Severity: **Low** (solid)

---

## Summary Table

| # | Finding | Severity | Status | Change |
|---|---------|----------|--------|--------|
| 1 | GitLab project/fork/group creation | **HIGH** | ðŸ†• NEW | moltbot can fork homelab |
| 2 | Loki unauthenticated WRITE (log injection) | **HIGH** | Open | Unchanged from 02-15 |
| 3 | Loki unauthenticated READ â€” 34 containers | **HIGH** | Open | +2 containers |
| 4 | Management subnet SSH reachable (10.4.0.1-2) | **Medium** | ðŸ†• NEW | Network path to mgmt |
| 5 | Env var secrets exposed | **Medium** | Open | Unchanged |
| 6 | IoT devices reachable | **Low** | Open | Unchanged |
| 7 | Vault RBAC âœ“ | **Low** | Secure | Deep-tested 14 paths |
| 8 | Container isolation âœ“ | **Low** | Secure | Zero capabilities confirmed |

## Orphaned Resources â€” Admin Action Needed

- GitLab project ID 10: `moltbot/redteam-test-deleteme` â€” DELETE NEEDED
- GitLab project ID 11: `moltbot/Monitoring` (fork of homelab) â€” DELETE NEEDED
- moltbot returns 500 on self-delete; admin must clean up

## Top 3 Recommendations
1. **Restrict GitLab moltbot permissions** â€” disable project/group creation, restrict fork ability
2. **Lock down Loki** â€” both read and write need authentication (3rd report in a row)
3. **Firewall management subnet** â€” block container access to 10.4.0.0/16 SSH
