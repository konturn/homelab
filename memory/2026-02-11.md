
## 03:30 — Image Update Check (Cron)

**Patch updates (3):**
- gitlab/gitlab-ee: 18.6.5-ee.0 → 18.6.6-ee.0
- linuxserver/jackett: 0.24.1089 → 0.24.1094
- vaultwarden/server: 1.35.2 → 1.35.3-alpine

**Unpinned images (4):** ambientweather2mqtt, audioserve, iperf3, mopidy — adding digest pins

Dispatched two sub-agents:
- `gitlab.mr.image-patches-2026-02-11` — patch updates MR
- `gitlab.mr.image-pins-2026-02-11` — digest pinning MR

## 04:00 — Infrastructure Audit (Cron)

Reviewed docker-compose.yml and ansible configs. Created 3 new GitLab issues with `agent-backlog` label:

1. **#51** — Add `cap_drop: ALL` to containers (only 1/44 has it, JIT service)
2. **#52** — Add `condition: service_healthy` to all 6 `depends_on` declarations (prevents startup race conditions)
3. **#53** — Move restic password from inline systemd `Environment=` to `EnvironmentFile=` (credential exposure reduction)

Skipped: health checks comprehensive (43/44 real services), no-new-privileges already on all containers, image updates handled by separate cron, existing open issues (#20, #27, #36, #40, #41, #44) not duplicated.

## 10:45 — Process Update from Noah

- **Don't create issues for simple fixes** — just do the work directly via MR
- Only create issues if the fix is complex enough to warrant discussion/planning
- Dispatched 3 sub-agents to fix #51 (cap_drop ALL), #52 (depends_on health), #53 (restic env file)

## 11:00-12:00 — Infrastructure Work & Outage

### cap_drop: ALL deployment
- MR !206 deployed but 14 containers broke and Noah had to revert:
  nginx, lab_nginx, iot_nginx, pihole, influxdb, mosquitto, nextcloud_db, wordpress_db, 6x snapclient_*
- Root cause: containers need specific capabilities (NET_BIND_SERVICE for nginx, CHOWN/SETUID/SETGID for DBs, audio caps for snapclients, etc.)
- Sub-agent dispatched to investigate and create fix MR but failed due to GitLab 502
- **TODO: Re-dispatch cap-drop fix once GitLab is back**

### Other MRs from audit
- MR !205: depends_on health conditions — pipeline passed, needs merge
- MR !206: original cap_drop ALL — merged but partially reverted
- Restic env file sub-agent — unclear status, may have failed during outage
- MR !204: image patch updates — still needs merge

### Network/GitLab outage
- ~11:00 EST: All homelab services became unreachable (nkontur.com, GitLab external+internal)
- Google reachable = not our container, it's the homelab network
- ~11:30: GitLab returning 502 (partially back but unhealthy)
- Likely related to GitLab EE upgrade (18.6.5→18.6.6) from !204 or network issues
- Notified Noah via Telegram

### Process update from Noah
- **Don't create GitLab issues for simple fixes** — just do the work directly
- Only file issues if fix is complex enough to need discussion
- Updated MEMORY.md with this preference
