[
  {
    "directive": "server",
    "args": [],
    "block": [
      {
        "directive": "listen",
        "args": [
          "443",
          "ssl",
          "http2"
        ]
      },
      {
        "directive": "server_name",
        "args": [
          "gitlab.lab.nkontur.com"
        ]
      },
      {
        "directive": "include",
        "args": [
          "ssl_config"
        ],
        "includes": []
      },
      {
        "directive": "client_max_body_size",
        "args": [
          "0"
        ]
      },
      {
        "directive": "location",
        "args": [
          "/"
        ],
        "block": [
          {
            "directive": "resolver",
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "args": [
              "$backend",
              "http://gitlab:80"
            ]
          },
          {
            "directive": "proxy_pass",
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_send_timeout",
            "args": [
              "300"
            ]
          },
          {
            "directive": "proxy_read_timeout",
            "args": [
              "300"
            ]
          },
          {
            "directive": "proxy_http_version",
            "args": [
              "1.1"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Upgrade",
              "$http_upgrade"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Connection",
              "$connection_upgrade"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Host",
              "$host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-For",
              "$proxy_add_x_forwarded_for"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-Host",
              "$server_name"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-Proto",
              "https"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-Ssl",
              "on"
            ]
          },
          {
            "directive": "proxy_buffers",
            "args": [
              "8",
              "32k"
            ]
          },
          {
            "directive": "proxy_buffer_size",
            "args": [
              "32k"
            ]
          }
        ]
      }
    ]
  },
  {
    "directive": "server",
    "line": 94,
    "args": [],
    "block": [
      {
        "directive": "listen",
        "line": 95,
        "args": [
          "443"
        ]
      },
      {
        "directive": "server_name",
        "line": 96,
        "args": [
          "paperless-ngx.lab.nkontur.com"
        ]
      },
      {
        "directive": "include",
        "line": 97,
        "args": [
          "ssl_config"
        ],
        "includes": []
      },
      {
        "directive": "location",
        "line": 98,
        "args": [
          "/"
        ],
        "block": [
          {
            "directive": "resolver",
            "line": 99,
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "line": 99,
            "args": [
              "$backend",
              "http://paperless-ngx:8000"
            ]
          },
          {
            "directive": "proxy_pass",
            "line": 99,
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_send_timeout",
            "line": 21,
            "args": [
              "240"
            ]
          },
          {
            "directive": "proxy_read_timeout",
            "line": 21,
            "args": [
              "240"
            ]
          },
          {
            "directive": "proxy_http_version",
            "line": 100,
            "args": [
              "1.1"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 101,
            "args": [
              "Upgrade",
              "$http_upgrade"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 102,
            "args": [
              "Connection",
              "$connection_upgrade"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 103,
            "args": [
              "Host",
              "$host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 104,
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 105,
            "args": [
              "X-Forwarded-For",
              "$proxy_add_x_forwarded_for"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 106,
            "args": [
              "X-Forwarded-Host",
              "$server_name"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 107,
            "args": [
              "X-Forwarded-Proto",
              "https"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 108,
            "args": [
              "X-Forwarded-Ssl",
              "on"
            ]
          },
          {
            "directive": "add_header",
            "line": 108,
            "args": [
              "P3P",
              "'CP=\"ALL DSP COR PSAa PSDa OUR NOR ONL UNI COM NAV\"'"
            ]
          }
        ]
      }
    ]
  },
  {
    "directive": "server",
    "line": 200,
    "args": [],
    "block": [
      {
        "directive": "listen",
        "line": 201,
        "args": [
          "443",
          "ssl"
        ]
      },
      {
        "directive": "server_name",
        "line": 202,
        "args": [
          "gitlab-registry.lab.nkontur.com"
        ]
      },
      {
        "directive": "include",
        "line": 203,
        "args": [
          "ssl_config"
        ],
        "includes": []
      },
      {
        "directive": "client_max_body_size",
        "line": 204,
        "args": [
          "0"
        ]
      },
      {
        "directive": "chunked_transfer_encoding",
        "line": 205,
        "args": [
          "on"
        ]
      },
      {
        "directive": "location",
        "line": 206,
        "args": [
          "/"
        ],
        "block": [
          {
            "directive": "resolver",
            "line": 207,
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "line": 208,
            "args": [
              "$backend",
              "http://gitlab:5050"
            ]
          },
          {
            "directive": "proxy_pass",
            "line": 209,
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_send_timeout",
            "line": 210,
            "args": [
              "900"
            ]
          },
          {
            "directive": "proxy_read_timeout",
            "line": 211,
            "args": [
              "900"
            ]
          },
          {
            "directive": "proxy_buffering",
            "line": 212,
            "args": [
              "off"
            ]
          },
          {
            "directive": "proxy_request_buffering",
            "line": 213,
            "args": [
              "off"
            ]
          },
          {
            "directive": "proxy_http_version",
            "line": 214,
            "args": [
              "1.1"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 215,
            "args": [
              "Host",
              "$http_host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 216,
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 217,
            "args": [
              "X-Forwarded-For",
              "$proxy_add_x_forwarded_for"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 218,
            "args": [
              "X-Forwarded-Proto",
              "https"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 219,
            "args": [
              "Docker-Distribution-Api-Version",
              "registry/2.0"
            ]
          }
        ]
      },
      {
        "directive": "location",
        "line": 220,
        "args": [
          "/v2/"
        ],
        "block": [
          {
            "directive": "resolver",
            "line": 221,
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "line": 222,
            "args": [
              "$backend",
              "http://gitlab:5050"
            ]
          },
          {
            "directive": "proxy_pass",
            "line": 223,
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_send_timeout",
            "line": 224,
            "args": [
              "900"
            ]
          },
          {
            "directive": "proxy_read_timeout",
            "line": 225,
            "args": [
              "900"
            ]
          },
          {
            "directive": "proxy_buffering",
            "line": 226,
            "args": [
              "off"
            ]
          },
          {
            "directive": "proxy_request_buffering",
            "line": 227,
            "args": [
              "off"
            ]
          },
          {
            "directive": "proxy_http_version",
            "line": 228,
            "args": [
              "1.1"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 229,
            "args": [
              "Host",
              "$http_host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 230,
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 231,
            "args": [
              "X-Forwarded-For",
              "$proxy_add_x_forwarded_for"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 232,
            "args": [
              "X-Forwarded-Proto",
              "https"
            ]
          },
          {
            "directive": "proxy_set_header",
            "line": 233,
            "args": [
              "Docker-Distribution-Api-Version",
              "registry/2.0"
            ]
          }
        ]
      }
    ]
  },
  {
    "directive": "server",
    "args": [],
    "block": [
      {
        "directive": "listen",
        "args": [
          "443",
          "ssl",
          "http2"
        ]
      },
      {
        "directive": "server_name",
        "args": [
          "jit.lab.nkontur.com"
        ]
      },
      {
        "directive": "include",
        "args": [
          "ssl_config"
        ],
        "includes": []
      },
      {
        "directive": "location",
        "args": [
          "/"
        ],
        "block": [
          {
            "directive": "resolver",
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "args": [
              "$backend",
              "http://jit-approval-svc:8080"
            ]
          },
          {
            "directive": "proxy_pass",
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Host",
              "$host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-For",
              "$proxy_add_x_forwarded_for"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-Proto",
              "$scheme"
            ]
          }
        ]
      }
    ]
  },
  {
    "directive": "server",
    "args": [],
    "block": [
      {
        "directive": "listen",
        "args": [
          "443",
          "ssl",
          "http2"
        ]
      },
      {
        "directive": "server_name",
        "args": [
          "browser.lab.nkontur.com"
        ]
      },
      {
        "directive": "include",
        "args": [
          "ssl_config"
        ],
        "includes": []
      },
      {
        "directive": "location",
        "args": [
          "/"
        ],
        "block": [
          {
            "directive": "resolver",
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "args": [
              "$backend",
              "http://chromium-browser:6080"
            ]
          },
          {
            "directive": "proxy_pass",
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_http_version",
            "args": [
              "1.1"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Upgrade",
              "$http_upgrade"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Connection",
              "$connection_upgrade"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Host",
              "$host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_read_timeout",
            "args": [
              "3600"
            ]
          },
          {
            "directive": "proxy_send_timeout",
            "args": [
              "3600"
            ]
          }
        ]
      }
    ]
  },
  {
    "directive": "server",
    "args": [],
    "block": [
      {
        "directive": "listen",
        "args": [
          "443",
          "ssl",
          "http2"
        ]
      },
      {
        "directive": "server_name",
        "args": [
          "loki.lab.nkontur.com"
        ]
      },
      {
        "directive": "include",
        "args": [
          "ssl_config"
        ],
        "includes": []
      },
      {
        "directive": "location",
        "args": [
          "/"
        ],
        "block": [
          {
            "directive": "resolver",
            "args": [
              "127.0.0.11"
            ]
          },
          {
            "directive": "set",
            "args": [
              "$backend",
              "http://loki:3100"
            ]
          },
          {
            "directive": "proxy_pass",
            "args": [
              "$backend"
            ]
          },
          {
            "directive": "proxy_http_version",
            "args": [
              "1.1"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "Host",
              "$host"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Real-IP",
              "$remote_addr"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-For",
              "$proxy_add_x_forwarded_for"
            ]
          },
          {
            "directive": "proxy_set_header",
            "args": [
              "X-Forwarded-Proto",
              "https"
            ]
          }
        ]
      }
    ]
  }
]